<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Safety Report</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 0; background:#0b0b0f; color:#fff; }
    .wrap { max-width: 520px; margin: 0 auto; padding: 18px; }
    .card { background:#141421; border:1px solid #24243a; border-radius: 14px; padding: 16px; }
    label { display:block; margin-top: 12px; font-size: 14px; opacity: .9; }
    select, textarea, input {
      width: 100%; margin-top: 6px; padding: 12px; border-radius: 10px;
      border: 1px solid #2c2c45; background:#0f0f18; color:#fff; font-size: 16px;
      box-sizing: border-box;
    }
    textarea { min-height: 110px; resize: vertical; }
    button {
      width: 100%; margin-top: 16px; padding: 14px; border: 0; border-radius: 12px;
      background: #7c3aed; color:#fff; font-size: 16px; font-weight: 700;
    }
    .note { margin-top: 10px; font-size: 12px; opacity: .8; line-height: 1.4; }
    .ok, .err { margin-top: 12px; padding: 10px; border-radius: 10px; display:none; }
    .ok { background:#123a24; border:1px solid #1f6b3d; }
    .err { background:#3a1212; border:1px solid #6b1f1f; }
  </style>
</head>
<body>
  <div class="wrap">
    <h2>Quick Safety Report (Anonymous)</h2>

    <div class="card">
      <form id="reportForm">
        <label>Type of situation</label>
        <select name="type" required>
          <option value="">Select...</option>
          <option value="Harassment">Harassment</option>
          <option value="Assault / Abuse">Assault / Abuse</option>
          <option value="Drugs / Over-intoxication">Drugs / Over-intoxication</option>
          <option value="Fight / Violence">Fight / Violence</option>
          <option value="Other">Other</option>
        </select>

        <label>Location</label>
        <select name="location" required>
          <option value="">Select...</option>
          <option value="Entrance">Entrance</option>
          <option value="Bar">Bar</option>
          <option value="Bathrooms">Bathrooms</option>
          <option value="Stage / Dancefloor">Stage / Dancefloor</option>
          <option value="Parking">Parking</option>
          <option value="Other">Other</option>
        </select>

        <label>Urgency</label>
        <select name="urgency" required>
          <option value="">Select...</option>
          <option value="High">High (immediate help needed)</option>
          <option value="Medium">Medium</option>
          <option value="Low">Low</option>
        </select>

        <label>Description (what happened / identifiers)</label>
        <textarea name="description" maxlength="600"
          placeholder="Example: Person in a black shirt near the bar bothering someone..."
          required></textarea>

        <label>Contact (optional)</label>
        <input name="contact" maxlength="80" placeholder="Telegram @username or phone (optional)" />

        <button type="submit">Submit report</button>

        <div class="note">
          Please don’t share unnecessary personal info. If there is immediate danger, find security/staff right away.
        </div>

        <div class="ok" id="ok">✅ Report sent. Thank you.</div>
        <div class="err" id="err">❌ Could not send. Please try again or find staff.</div>
      </form>
    </div>
  </div>

<script>
  const form = document.getElementById('reportForm');
  const ok = document.getElementById('ok');
  const err = document.getElementById('err');

  form.addEventListener('submit', async (e) => {
    e.preventDefault();
    ok.style.display = 'none';
    err.style.display = 'none';

    const data = Object.fromEntries(new FormData(form).entries());

    try {
      const res = await fetch('/api/report', {
        method: 'POST',
        headers: {'Content-Type':'application/json'},
        body: JSON.stringify(data)
      });
      if (!res.ok) throw new Error('Bad status');
      form.reset();
      ok.style.display = 'block';
    } catch (e2) {
      err.style.display = 'block';
    }
  });
</script>
</body>
</html>